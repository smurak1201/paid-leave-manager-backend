# 有給休暇管理アプリ バックエンド（Laravel）学習ガイド

このドキュメントは、当アプリのバックエンド（Laravel）側のソースコードを効率的に学ぶためのポイントや、読む順序のガイドです。PHP/Laravel の API 設計・業務ロジック・バリデーション・日本の有給休暇制度への対応状況を理解しましょう。

---

## 1. 学習時に意識すべきポイント

-   **責務分離**: コントローラ・モデル・ルーティングの役割分担を意識し、どこで何を担当しているかを把握しましょう。
-   **バリデーション**: リクエストバリデーション（`$request->validate`）やエラーハンドリングの実装方法を確認しましょう。
-   **業務ロジック**: 有給付与・消化・繰越・時効消滅・最大保有日数・FIFO 消化順序など、日本法令に即したロジックがどこでどう実装されているかを意識しましょう（`app/Http/Controllers/LeaveUsageController.php`）。
-   **API 設計**: RESTful なルーティング・リクエスト/レスポンス形式・エラー時の返却値設計を確認しましょう。
-   **モデル設計**: `Employee`, `LeaveUsage`, `LeaveGrantMaster` などのモデル構造・リレーション・fillable 設定を確認しましょう。
-   **保守性・拡張性**: コードの分割・命名・バリデーション共通化・例外処理の工夫を探しましょう。
-   **法令準拠ロジック**: 日本の有給休暇制度にどこまで対応しているか、未対応要件は何かを意識しましょう。

---

## 2. ソースコードを読むおすすめの順序

1. **`routes/api.php`**
    - API エンドポイントとコントローラの対応関係を把握。
2. **`app/Http/Controllers/LeaveUsageController.php`**
    - 有給付与・消化・繰越・時効消滅・最大保有日数・FIFO 消化順序など、主要な業務ロジックの実装を確認。
    - showSummary/store/destroy/generateGrants などの関数ごとにロジックを追いましょう。
3. **モデル**
    - `app/Models/Employee.php`, `LeaveUsage.php`, `LeaveGrantMaster.php`
    - fillable, リレーション、DB 設計の意図を確認。
4. **Seeder・マスターデータ**
    - `database/seeders/LeaveGrantMasterSeeder.php` で付与マスターの内容を確認。
5. **バリデーション・エラー処理**
    - 各 API のバリデーション・例外処理・エラーレスポンス設計を確認。

---

## 3. 日本の有給休暇制度に対応しているロジック・未対応ロジック

### 対応済みロジック

-   勤続年数に応じた付与日数自動計算（正社員モデル）
-   付与日ごとに 2 年の有効期限管理
-   前回付与分の残日数（最大 20 日）を繰越
-   最大保有日数 40 日（付与＋繰越の合計）
-   FIFO（先入れ先出し）消化順序
-   有効期限切れ分の自動失効
-   日単位での有給取得・管理

### 未対応・追加実装が必要な主なロジック

-   年 5 日取得義務（2019 年法改正）
-   出勤率 8 割判定による付与可否
-   雇用形態別付与（パート・短時間労働者等）
-   時間単位・半日単位有給
-   付与基準日（入社日以外の基準日管理）
-   失効日数の明示・管理
-   特別休暇・その他休暇との区別

---

## 4. 学びを深めるためのアクション例

-   バリデーションやロジック部分を書き換えて動作を試す
-   新しい付与ルールや消化順序を追加してみる
-   API レスポンス形式やエラー処理をカスタマイズしてみる
-   モデル・Seeder・マスターデータを拡張してみる
-   設計コメントを自分なりに書き換えてみることで、理解を深める

---

## 5. まとめ

-   「なぜこの設計なのか」「どこで何をしているか」を常に意識し、コメントや関数名を手がかりに全体像 → 詳細へと段階的に理解を深めましょう。
-   疑問点や改善案があれば、実際に手を動かして試すことでより実践的な力が身につきます。
-   設計コメントを活用し、他のプロジェクトや実務にも応用できる「設計意図を伝える力」を養いましょう。

---

このガイドを活用し、実務・学習の両面で役立つ Laravel/PHP バックエンド開発力を身につけてください！
